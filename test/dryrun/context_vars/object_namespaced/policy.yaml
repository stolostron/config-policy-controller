apiVersion: policy.open-cluster-management.io/v1
kind: ConfigurationPolicy
metadata:
  name: policy-object-var-templated-name
spec:
  remediationAction: inform
  namespaceSelector:
    matchlabels:
      box: big
  object-templates:
    - complianceType: musthave
      recordDiff: InStatus
      objectSelector:
        matchLabels: {}
      objectDefinition:
        apiVersion: v1
        kind: ConfigMap
        metadata:
          name: '{{ .ObjectName }}'
          namespace: '{{ .ObjectNamespace }}'
          labels:
            new-label: '{{ ne (printf "%s" .ObjectName) "inventory" | skipObject }}{{ (fromYAML (index .Object.data "inventory.yaml")).appliance }}'
